{% extends 'base.html' %}

{% block title %} Blog-Post {% endblock %}

{% block css %} 
    <style>

        .content {    
          overflow-wrap: anywhere; 
          text-align: justify;
          
        }

        #comment {
        border: none;
        border-bottom: 1px solid black;
        background-color: none;
        outline: 0;
        font-size: 18px;
        max-width: 500px;
        width: 500px;
        height: 35px;
      }

    #comment:focus {
    border: none;
    border-bottom: 1px solid black;
    background-color: none;
    outline: 0;
    max-width: 500px;
    width: 500px;
    height: 35px;
    }

    </style>
{% endblock %}

{% block body %}

{% load static %}
{% load humanize %} 

<div class="container my-2 mx-2" >
    <div class="row g-5">
        <div class="col-md-8">

            <article class="my-4 blog-post border-bottom">
                <h2 class="display-5 link-body-emphasis mb-1">{{post.title}}</h2>
                <p class="blog-post-meta my-2">{{post.timestamp}} by <a href="#">{{post.author}}</a></p>
            </article>

            <article class="my-4 blog-post border-bottom">
                <p class="blog-post-meta" style="text-align: justify;">{{post.content}}</p>
            </article>
            
            <!-- For comment -->
            <div>
                <h2 class="border-bottom p-2">Comments({{comments.count}})</h2>
                <div class="my-3 mb-3">
                    {% if messages %} <!-- main condition-->
                        {% for message in messages %}
                                <div {% if message.tags %} class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert" {% endif %}>
                                    <strong>Hello!</strong> {{ message }}
                                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                                </div>
                        {% endfor %}
                    {% endif %} <!-- END main condition-->
                </div>

                {% if user.is_authenticated %}
                    <!-- Post Comment -->
                    <form action="/blog/commentpost/" method="post">
                        {% csrf_token %}
                        <div class="my-4 ms-3">
                            <input type="text" name="comment" id="comment" placeholder="Your Valueable Comment." required autocomplete="off"> <br>
                            <input type="hidden" name="post_pno" value="{{post.pno}}" >
                            <button type="submit" class="btn btn-primary btn-sm my-2">Comment</button>  
                        </div>                         
                    </form>
                {% else %}
                    <div  class="alert alert-warning alert-dismissible fade show" role="alert" >
                        <strong>Please Logged In, For Post Your Valueable Comment.</strong>
                        <button class="btn btn-primary btn-sm" data-bs-toggle="modal" data-bs-target="#staticBackdrop-login">Login</button> 
                    </div>
                {% endif %}

                

                <!-- Show Comments -->
                {% for comment in comments %}
                    <div class="row my-3 mx-2">
                        <div class="col-md-1 ">
                            <img src="{%static 'blog/user.png' %}" class="rounded mx-auto d-block w-100 p-1 " alt="image">
                        </div>
                        <div class="col-md-11">
                            <b>{{comment.user.username}}</b> <span class="badge text-bg-secondary">{{comment.timestamp|naturaltime}}</span>
                            <div class="content my-1">
                                {{comment.comment}}
                            </div>
                        </div>
                    </div>
                {% endfor %}
                
            </div>
    
        </div>
    
        <div class="col-md-4 ">
            <div class="position-sticky my-2" style="top: 2rem;">
                <div class="p-4 mb-3 bg-body-tertiary rounded">
                    <h4 class="fst-italic">About</h4>
                    <p class="mb-0">{{post.summary}}</p>
                </div>

                <div class="p-4">
                    <img src="/media/{{ post.image }}" alt="Thumbnail" width="300px" height="350px" style="object-fit: cover;">
                </div>
    
    
    
                <div class="p-4">
                    <h4 class="fst-italic">Elsewhere</h4>
                    <ol class="list-unstyled">
                        <li><a href="#">GitHub</a></li>
                        <li><a href="#">Twitter</a></li>
                        <li><a href="#">Facebook</a></li>
                    </ol>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}